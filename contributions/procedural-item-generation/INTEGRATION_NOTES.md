# Integration Notes - Class-Specific Item Restrictions

## Overview

All items generated by this system include class restrictions. **Every item has a `requiredClass` property** that must be checked during equipment validation to ensure items can only be equipped by the correct class.

## Class-Specific Items

### Weapons (One per class)

| Item | Required Class | Notes |
|------|---------------|-------|
| Longsword | `warrior` | Only warriors can equip |
| Staff | `mage` | Only mages can equip |
| Dagger | `rogue` | Only rogues can equip |
| Mace | `cleric` | Only clerics can equip |

### Armor Kits (Two per class, complete sets)

| Item | Required Class | Notes |
|------|---------------|-------|
| Full Plate | `warrior` | Heavy armor, only warriors can equip |
| Chain Mail | `warrior` | Medium armor, only warriors can equip |
| Mage Robes | `mage` | Light armor, only mages can equip |
| Enchanted Cloak | `mage` | Light armor, only mages can equip |
| Leather Armor | `rogue` | Light armor, only rogues can equip |
| Studded Leather | `rogue` | Light armor, only rogues can equip |
| Scale Mail | `cleric` | Medium armor, only clerics can equip |
| Breastplate | `cleric` | Medium armor, only clerics can equip |

## Item Structure

Generated items include the following fields:

```typescript
interface GeneratedItem {
    id: string;
    name: string;
    type: 'weapon' | 'armor';
    requiredClass: 'warrior' | 'mage' | 'rogue' | 'cleric';  // USE THIS for validation
    class: string;  // Deprecated - use requiredClass instead
    // ... other properties
}
```

## Equipment Validation

### Required Check

**You MUST check `item.requiredClass` against the agent's class before allowing equipment.**

### Pseudocode Example

```typescript
function canEquipItem(agent: Agent, item: GeneratedItem): boolean {
    // Check if item has class restriction
    if (item.requiredClass) {
        // Item is class-specific - must match agent's class
        if (item.requiredClass !== agent.class) {
            return false; // Class mismatch - cannot equip
        }
    }
    
    // Additional validation (slot availability, level requirements, etc.)
    // ...
    
    return true; // All checks passed
}
```

### TypeScript Example

```typescript
import { ItemGenerator } from './item-generation';

const generator = new ItemGenerator(seed);
const item = generator.generateItem(context, level, classPreference, rarityModifier);

// In your equipment system:
function equipItem(agent: Agent, item: GeneratedItem): void {
    // Validate class restriction
    if (item.requiredClass && item.requiredClass !== agent.class) {
        throw new Error(
            `Only ${item.requiredClass}s can equip ${item.name}. ` +
            `Agent is a ${agent.class}.`
        );
    }
    
    // Proceed with equipping...
    agent.equipment.weapon = item; // or armor, etc.
}
```

### JavaScript Example

```javascript
function equipItem(agent, item) {
    // Validate class restriction
    if (item.requiredClass && item.requiredClass !== agent.class) {
        console.error(`Equipment failed: ${item.name} requires ${item.requiredClass}, but agent is ${agent.class}`);
        return false;
    }
    
    // Proceed with equipping...
    agent.equipment.weapon = item;
    return true;
}
```

## Integration Checklist

- [ ] Check `item.requiredClass` exists on all generated items
- [ ] Implement equipment validation that compares `item.requiredClass` with `agent.class`
- [ ] Display class restriction in UI (e.g., "Warrior Only")
- [ ] Prevent equipment actions when class doesn't match
- [ ] Show appropriate error message when equip fails due to class mismatch
- [ ] Test with each class to ensure restrictions work

## Error Handling

When an equip attempt fails due to class mismatch:

1. **Don't equip the item** - Return early or throw error
2. **Log the failure** - For debugging purposes
3. **Inform the user** - Show clear message: "This item can only be equipped by [class]"
4. **Consider visual feedback** - Gray out items in inventory that can't be equipped

## Notes

- The `class` property is deprecated but still present for backwards compatibility
- Always use `requiredClass` for new code
- If `requiredClass` is undefined/null, the item can be equipped by any class (shouldn't happen with current system)
- All items in the current system have class restrictions

